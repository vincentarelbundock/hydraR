<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>CLAUDE.md • hydraR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" sizes="any" href="favicon.ico"><link rel="manifest" href="site.webmanifest"><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="CLAUDE.md"><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">hydraR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/commandline.html">Command line</a></li>
    <li><a class="dropdown-item" href="articles/composition.html">Interpolation and Composition</a></li>
    <li><a class="dropdown-item" href="articles/override.html">Override</a></li>
    <li><a class="dropdown-item" href="articles/placeholders.html">Placeholders</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vincentarelbundock/hydraR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.svg" class="logo" alt=""><h1>CLAUDE.md</h1>
      <small class="dont-index">Source: <a href="https://github.com/vincentarelbundock/hydraR/blob/HEAD/CLAUDE.md" class="external-link"><code>CLAUDE.md</code></a></small>
    </div>

<div id="claudemd" class="section level1">

<p>This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.</p>
<div class="section level2">
<h2 id="what-this-is">What This Is<a class="anchor" aria-label="anchor" href="#what-this-is"></a></h2>
<p>hydraR is an R package that ports Facebook/Meta’s Hydra configuration composition framework to R. It enables hierarchical YAML config composition with defaults lists, CLI-style overrides, and OmegaConf-style interpolation resolvers.</p>
<p><strong>API:</strong> The public API is minimal: <code>initialize()</code> and <code><a href="reference/compose.html">compose()</a></code>. Composed configs are returned as <code>HydraConfig</code> S3 objects (which behave like lists but have enhanced printing).</p>
</div>
<div class="section level2">
<h2 id="common-commands">Common Commands<a class="anchor" aria-label="anchor" href="#common-commands"></a></h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">make</span> install        <span class="co"># Install the package locally (no deps)</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">make</span> testall        <span class="co"># Build, install, and run all tinytest tests</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">make</span> testone TESTFILE=inst/tinytest/test_initialize.R  <span class="co"># Run a single test file</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">make</span> document       <span class="co"># Regenerate roxygen2 docs + render README.qmd → README.md</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">make</span> check          <span class="co"># Full R CMD check</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">make</span> clean          <span class="co"># Remove build artifacts</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="architecture">Architecture<a class="anchor" aria-label="anchor" href="#architecture"></a></h2>
<p>The package follows a two-phase pattern: <strong>initialize</strong> (point at config root) → <strong>compose</strong> (resolve defaults + apply overrides).</p>
<div class="section level3">
<h3 id="source-modules-r">Source modules (<code>R/</code>)<a class="anchor" aria-label="anchor" href="#source-modules-r"></a></h3>
<div class="section level4">
<h4 id="core-composition-flow">Core composition flow<a class="anchor" aria-label="anchor" href="#core-composition-flow"></a></h4>
<ul><li>
<strong>initialize.R</strong> — Initialization API and state management. Exports <code>initialize()</code> and manages package-level state in the <code>.initialize_state</code> environment. Handles config path resolution and initialization assertions.</li>
<li>
<strong>compose.R</strong> — Core composition engine and exported <code><a href="reference/compose.html">compose()</a></code> function. Orchestrates: primary config loading → defaults resolution → group config merging → overrides application → interpolation resolution. Returns a <code>HydraConfig</code> S3 object.</li>
<li>
<strong>config_defaults.R</strong> — Defaults list parsing and normalization. Handles <code>_self_</code> positioning, group→option entries, and config-path entries from the <code>defaults:</code> key in YAML configs.</li>
<li>
<strong>config_overrides.R</strong> — CLI-style override parsing and application. Supports <code>key=value</code>, <code>+key=value</code>, and <code>~key</code> syntax with dot-path navigation, booleans, null, numbers, and inline YAML.</li>
<li>
<strong>config_merge.R</strong> — Deep merge implementation for named lists (right overwrites left, recursively).</li>
</ul></div>
<div class="section level4">
<h4 id="interpolation-system">Interpolation system<a class="anchor" aria-label="anchor" href="#interpolation-system"></a></h4>
<ul><li>
<strong>config_interpolation.R</strong> — Interpolation resolution engine. Handles <code>${...}</code> expressions with cycle detection, relative paths (<code>.</code>, <code>..</code>), and bracket notation (<code>[0]</code>, <code>['key']</code>). Dispatches to resolver functions for <code>oc.*</code> calls.</li>
<li>
<strong>resolver_dispatch.R</strong> — Resolver dispatch logic. Routes <code>oc.env</code>, <code>oc.select</code>, <code>oc.decode</code>, <code>oc.create</code>, <code>oc.deprecated</code>, <code>oc.dict.keys</code>, and <code>oc.dict.values</code> to their implementations.</li>
<li>
<strong>resolver_oc_env.R</strong> — <code>${oc.env:VAR,default}</code> resolver for environment variables.</li>
<li>
<strong>resolver_oc_select.R</strong> — <code>${oc.select:path,default}</code> resolver for safe config lookups with fallback.</li>
<li>
<strong>resolver_oc_decode.R</strong> — <code>${oc.decode:string}</code> resolver for base64 decoding.</li>
<li>
<strong>resolver_oc_create.R</strong> — <code>${oc.create:{...}}</code> resolver for inline YAML/list construction.</li>
<li>
<strong>resolver_oc_deprecated.R</strong> — <code>${oc.deprecated:...}</code> resolver for deprecation warnings.</li>
<li>
<strong>resolver_oc_dict.R</strong> — <code>${oc.dict.keys:path}</code> and <code>${oc.dict.values:path}</code> resolvers for dictionary introspection.</li>
<li>
<strong>resolver_utils.R</strong> — Shared resolver utilities (argument parsing, quote stripping, etc.).</li>
</ul></div>
<div class="section level4">
<h4 id="utilities-and-output">Utilities and output<a class="anchor" aria-label="anchor" href="#utilities-and-output"></a></h4>
<ul><li>
<strong>config_utils.R</strong> — Low-level configuration utilities: dot-path tokenization with quote support, nested list get/set operations (<code>.get_cfg_value</code>, <code>.set_cfg_value</code>), unquoted character search (<code>.first_unquoted_index</code>).</li>
<li>
<strong>print.R</strong> — S3 print method for <code>HydraConfig</code>. Renders configs as ASCII trees with configurable depth (controlled by <code>levels</code> argument or <code>options(hydraR.print.max_depth = n)</code>).</li>
</ul></div>
</div>
<div class="section level3">
<h3 id="conventions">Conventions<a class="anchor" aria-label="anchor" href="#conventions"></a></h3>
<ul><li>Internal functions use <code>.name</code> naming (dot prefix for internals).</li>
<li>Parameter validation uses the <code>checkmate</code> package.</li>
<li>Documentation is roxygen2-generated (<code>man/</code> files should not be edited by hand).</li>
<li>Tests live in <code>inst/tinytest/</code> split by functionality, with YAML fixtures in <code>inst/examples/</code>.</li>
<li>Test fixtures include group structure: <code>db/mysql.yaml</code>, <code>db/postgres.yaml</code>, <code>config.yaml</code>, <code>config_alt.yaml</code>, <code>config_interp.yaml</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a></h3>
<p>Minimal: <code>yaml</code> (YAML parsing), <code>checkmate</code> (parameter validation), <code>tinytest</code> (testing, suggested only).</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vincent Arel-Bundock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

